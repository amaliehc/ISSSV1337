---
title: "Excel fun"
author: "Torbj√∏rn Skinnemoen Ottersen"
date: '2022-07-11'
output: 
  html_document: 
    df_print: kable
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries, include=FALSE}
library(readxl)
library(tidyverse)
```

## Long vs. wide data
![](Images/wideLong1-1.png)

Fra [Statology](https://www.statology.org/long-vs-wide-data/).

## Reading long file

```{r}
test <- read_excel("Data/OPXfinans test.xlsx")
test
```

## Tidying

```{r}
test2 <- test |> 
  mutate(
    category = ifelse(is.na(value), entry, NA)
  ) |> 
  fill(category) |> 
  fill(year) |> 
  filter(!is.na(value))
test2 |> 
  filter()

test2_no_totals <- test2 |> 
  filter(
    !str_detect(entry, "^Sum") & !str_detect(entry, "^Total")
  )

test2_no_totals
test2_no_totals |>
  group_by(category) |> 
  summarise(
    sum = sum(value)
  )
```

## Wide file

```{r}
read_excel("Data/Book1.xlsx") |> 
  filter(!is.na(Year))
```


