---
title: "Excel fun"
author: "Torbj√∏rn Skinnemoen Ottersen"
date: '2022-07-11'
output: 
  html_document: 
    df_print: kable
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries, include=FALSE}
library(readxl)
library(tidyverse)
```

## Reading long file

```{r}
test <- read_excel("Data/OPXfinans test.xlsx")
test
```

## Tidying

```{r}
test2 <- test |> 
  mutate(
    category = ifelse(is.na(value), entry, NA)
  ) |> 
  fill(category) |> 
  fill(year) |> 
  filter(!is.na(value))
test2
```

## Wide file

```{r}
read_excel("Data/Book1.xlsx") |> 
  filter(!is.na(Year))
```


